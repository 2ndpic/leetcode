# åœ¨ä¸€ä¸ªå°åŸå¸‚é‡Œï¼Œæœ‰ m ä¸ªæˆ¿å­æ’æˆä¸€æ’ï¼Œä½ éœ€è¦ç»™æ¯ä¸ªæˆ¿å­æ¶‚ä¸Š n ç§é¢œè‰²ä¹‹ä¸€ï¼ˆé¢œè‰²ç¼–å·ä¸º 1 åˆ° n ï¼‰ã€‚æœ‰çš„æˆ¿å­å»å¹´å¤å¤©å·²ç»æ¶‚è¿‡é¢œè‰²äº†ï¼Œæ‰€ä»¥è¿™äº›æˆ¿å­ä¸éœ€è¦
# è¢«é‡æ–°æ¶‚è‰²ã€‚ 
# 
#  æˆ‘ä»¬å°†è¿ç»­ç›¸åŒé¢œè‰²å°½å¯èƒ½å¤šçš„æˆ¿å­ç§°ä¸ºä¸€ä¸ªè¡—åŒºã€‚ï¼ˆæ¯”æ–¹è¯´ houses = [1,2,2,3,3,2,1,1] ï¼Œå®ƒåŒ…å« 5 ä¸ªè¡—åŒº [{1}, {2,2}
# , {3,3}, {2}, {1,1}] ã€‚ï¼‰ 
# 
#  ç»™ä½ ä¸€ä¸ªæ•°ç»„ houses ï¼Œä¸€ä¸ª m * n çš„çŸ©é˜µ cost å’Œä¸€ä¸ªæ•´æ•° target ï¼Œå…¶ä¸­ï¼š 
# 
#  
#  houses[i]ï¼šæ˜¯ç¬¬ i ä¸ªæˆ¿å­çš„é¢œè‰²ï¼Œ0 è¡¨ç¤ºè¿™ä¸ªæˆ¿å­è¿˜æ²¡æœ‰è¢«æ¶‚è‰²ã€‚ 
#  cost[i][j]ï¼šæ˜¯å°†ç¬¬ i ä¸ªæˆ¿å­æ¶‚æˆé¢œè‰² j+1 çš„èŠ±è´¹ã€‚ 
#  
# 
#  è¯·ä½ è¿”å›æˆ¿å­æ¶‚è‰²æ–¹æ¡ˆçš„æœ€å°æ€»èŠ±è´¹ï¼Œä½¿å¾—æ¯ä¸ªæˆ¿å­éƒ½è¢«æ¶‚è‰²åï¼Œæ°å¥½ç»„æˆ target ä¸ªè¡—åŒºã€‚å¦‚æœæ²¡æœ‰å¯ç”¨çš„æ¶‚è‰²æ–¹æ¡ˆï¼Œè¯·è¿”å› -1 ã€‚ 
# 
#  
# 
#  ç¤ºä¾‹ 1ï¼š 
# 
#  è¾“å…¥ï¼šhouses = [0,0,0,0,0], cost = [[1,10],[10,1],[10,1],[1,10],[5,1]], m = 5, n
#  = 2, target = 3
# è¾“å‡ºï¼š9
# è§£é‡Šï¼šæˆ¿å­æ¶‚è‰²æ–¹æ¡ˆä¸º [1,2,2,1,1]
# æ­¤æ–¹æ¡ˆåŒ…å« target = 3 ä¸ªè¡—åŒºï¼Œåˆ†åˆ«æ˜¯ [{1}, {2,2}, {1,1}]ã€‚
# æ¶‚è‰²çš„æ€»èŠ±è´¹ä¸º (1 + 1 + 1 + 1 + 5) = 9ã€‚
#  
# 
#  ç¤ºä¾‹ 2ï¼š 
# 
#  è¾“å…¥ï¼šhouses = [0,2,1,2,0], cost = [[1,10],[10,1],[10,1],[1,10],[5,1]], m = 5, n
#  = 2, target = 3
# è¾“å‡ºï¼š11
# è§£é‡Šï¼šæœ‰çš„æˆ¿å­å·²ç»è¢«æ¶‚è‰²äº†ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæ¶‚è‰²æ–¹æ¡ˆä¸º [2,2,1,2,2]
# æ­¤æ–¹æ¡ˆåŒ…å« target = 3 ä¸ªè¡—åŒºï¼Œåˆ†åˆ«æ˜¯ [{2,2}, {1}, {2,2}]ã€‚
# ç»™ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªæˆ¿å­æ¶‚è‰²çš„èŠ±è´¹ä¸º (10 + 1) = 11ã€‚
#  
# 
#  ç¤ºä¾‹ 3ï¼š 
# 
#  è¾“å…¥ï¼šhouses = [0,0,0,0,0], cost = [[1,10],[10,1],[1,10],[10,1],[1,10]], m = 5, 
# n = 2, target = 5
# è¾“å‡ºï¼š5
#  
# 
#  ç¤ºä¾‹ 4ï¼š 
# 
#  è¾“å…¥ï¼šhouses = [3,1,2,3], cost = [[1,1,1],[1,1,1],[1,1,1],[1,1,1]], m = 4, n = 3
# , target = 3
# è¾“å‡ºï¼š-1
# è§£é‡Šï¼šæˆ¿å­å·²ç»è¢«æ¶‚è‰²å¹¶ç»„æˆäº† 4 ä¸ªè¡—åŒºï¼Œåˆ†åˆ«æ˜¯ [{3},{1},{2},{3}] ï¼Œæ— æ³•å½¢æˆ target = 3 ä¸ªè¡—åŒºã€‚
#  
# 
#  
# 
#  æç¤ºï¼š 
# 
#  
#  m == houses.length == cost.length 
#  n == cost[i].length 
#  1 <= m <= 100 
#  1 <= n <= 20 
#  1 <= target <= m 
#  0 <= houses[i] <= n 
#  1 <= cost[i][j] <= 10^4 
#  
#  Related Topics åŠ¨æ€è§„åˆ’ 
#  ğŸ‘ 124 ğŸ‘ 0

from typing import List
# leetcode submit region begin(Prohibit modification and deletion)
class Solution:
    def minCost(self, houses: List[int], cost: List[List[int]], m: int, n: int, target: int) -> int:
        """
        f(i, j, k)è¡¨ç¤ºè€ƒè™‘å‰ié—´æˆ¿å­ï¼Œæœ€åä¸€é—´ï¼ˆç¬¬ié—´ï¼‰çš„ç²‰åˆ·çŠ¶æ€ä¸ºj,å½¢æˆçš„åˆ†åŒºæ•°é‡ä¸ºk,æœ€å°æ€»èŠ±è´¹
        ä¸¤ç§æƒ…å†µè®¨è®ºï¼Œç¬¬ié—´ä¹‹å‰ç²‰åˆ·äº†ï¼Œæˆ–è€…æ²¡æœ‰ç²‰åˆ·
        - ç²‰åˆ·äº†
            f(i, j, k) = min(f(i-1, j, k), f(i-1, p, k-1))  houses[i-1] == j and p != j
                         inf                                houses[i-1] != j
        - æ²¡æœ‰ç²‰åˆ·
            f(i, j, k) = min(f(i-1, j, k) + cost[i-1][j-1], f(i-1, p, k-1) + cost[i-1][p-1])   p != j
        """
        f = [[[0] * (target + 1) for _ in range(n + 1)] for _ in range(m + 1)]
        for i in range(m + 1):
            for j in range(n + 1):
                f[i][j][0] = float('inf')
        for i in range(1, m + 1):
            for j in range(1, n + 1):
                for k in range(1, target + 1):
                    if k > i:
                        f[i][j][k] = float('inf')
                        continue
                    if houses[i - 1] == j:
                        f[i][j][k] = f[i-1][j][k]
                        for p in range(1, n + 1):
                            if p == j: continue
                            f[i][j][k] = min(f[i][j][k], f[i-1][p][k-1])
                    elif houses[i - 1] == 0:
                        f[i][j][k] = f[i-1][j][k] + cost[i-1][j-1]
                        for p in range(1, n + 1):
                            if p == j: continue
                            f[i][j][k] = min(f[i][j][k], (f[i-1][p][k-1] + cost[i-1][j-1]))
                    else:
                        f[i][j][k] = float('inf')
        ans = float('inf')
        for i in range(1, n + 1):
            ans = min(ans, f[m][i][target])
        return ans if ans < float('inf') else -1

# leetcode submit region end(Prohibit modification and deletion)
houses = [0,2,1,2,0];cost = [[1,10],[10,1],[10,1],[1,10],[5,1]];m = 5; n= 2;target = 3
print(Solution().minCost(houses, cost, m, n, target))