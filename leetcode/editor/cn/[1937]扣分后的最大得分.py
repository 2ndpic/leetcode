# ç»™ä½ ä¸€ä¸ª m x n çš„æ•´æ•°çŸ©é˜µ points ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ã€‚ä¸€å¼€å§‹ä½ çš„å¾—åˆ†ä¸º 0 ï¼Œä½ æƒ³æœ€å¤§åŒ–ä»çŸ©é˜µä¸­å¾—åˆ°çš„åˆ†æ•°ã€‚ 
# 
#  ä½ çš„å¾—åˆ†æ–¹å¼ä¸ºï¼šæ¯ä¸€è¡Œ ä¸­é€‰å–ä¸€ä¸ªæ ¼å­ï¼Œé€‰ä¸­åæ ‡ä¸º (r, c) çš„æ ¼å­ä¼šç»™ä½ çš„æ€»å¾—åˆ† å¢åŠ  points[r][c] ã€‚ 
# 
#  ç„¶è€Œï¼Œç›¸é‚»è¡Œä¹‹é—´è¢«é€‰ä¸­çš„æ ¼å­å¦‚æœéš”å¾—å¤ªè¿œï¼Œä½ ä¼šå¤±å»ä¸€äº›å¾—åˆ†ã€‚å¯¹äºç›¸é‚»è¡Œ r å’Œ r + 1 ï¼ˆå…¶ä¸­ 0 <= r < m - 1ï¼‰ï¼Œé€‰ä¸­åæ ‡ä¸º (r, c
# 1) å’Œ (r + 1, c2) çš„æ ¼å­ï¼Œä½ çš„æ€»å¾—åˆ† å‡å°‘ abs(c1 - c2) ã€‚ 
# 
#  è¯·ä½ è¿”å›ä½ èƒ½å¾—åˆ°çš„ æœ€å¤§ å¾—åˆ†ã€‚ 
# 
#  abs(x) å®šä¹‰ä¸ºï¼š 
# 
#  
#  å¦‚æœ x >= 0 ï¼Œé‚£ä¹ˆå€¼ä¸º x ã€‚ 
#  å¦‚æœ x < 0 ï¼Œé‚£ä¹ˆå€¼ä¸º -x ã€‚ 
#  
# 
#  
# 
#  ç¤ºä¾‹ 1ï¼š 
# 
#  
# è¾“å…¥ï¼špoints = [[1,2,3],[1,5,1],[3,1,1]]
# è¾“å‡ºï¼š9
# è§£é‡Šï¼š
# è“è‰²æ ¼å­æ˜¯æœ€ä¼˜æ–¹æ¡ˆé€‰ä¸­çš„æ ¼å­ï¼Œåæ ‡åˆ†åˆ«ä¸º (0, 2)ï¼Œ(1, 1) å’Œ (2, 0) ã€‚
# ä½ çš„æ€»å¾—åˆ†å¢åŠ  3 + 5 + 3 = 11 ã€‚
# ä½†æ˜¯ä½ çš„æ€»å¾—åˆ†éœ€è¦æ‰£é™¤ abs(2 - 1) + abs(1 - 0) = 2 ã€‚
# ä½ çš„æœ€ç»ˆå¾—åˆ†ä¸º 11 - 2 = 9 ã€‚
#  
# 
#  ç¤ºä¾‹ 2ï¼š 
# 
#  
# è¾“å…¥ï¼špoints = [[1,5],[2,3],[4,2]]
# è¾“å‡ºï¼š11
# è§£é‡Šï¼š
# è“è‰²æ ¼å­æ˜¯æœ€ä¼˜æ–¹æ¡ˆé€‰ä¸­çš„æ ¼å­ï¼Œåæ ‡åˆ†åˆ«ä¸º (0, 1)ï¼Œ(1, 1) å’Œ (2, 0) ã€‚
# ä½ çš„æ€»å¾—åˆ†å¢åŠ  5 + 3 + 4 = 12 ã€‚
# ä½†æ˜¯ä½ çš„æ€»å¾—åˆ†éœ€è¦æ‰£é™¤ abs(1 - 1) + abs(1 - 0) = 1 ã€‚
# ä½ çš„æœ€ç»ˆå¾—åˆ†ä¸º 12 - 1 = 11 ã€‚
#  
# 
#  
# 
#  æç¤ºï¼š 
# 
#  
#  m == points.length 
#  n == points[r].length 
#  1 <= m, n <= 105 
#  1 <= m * n <= 105 
#  0 <= points[r][c] <= 105 
#  
#  ğŸ‘ 27 ğŸ‘ 0

from typing import List
# leetcode submit region begin(Prohibit modification and deletion)
class Solution:
    def maxPoints(self, points: List[List[int]]) -> int:
        """
        f[i][j]è¡¨ç¤ºå‰iè¡Œé€‰å–poins[i][j]çš„æœ€å¤§å¾—åˆ†
        f[i][j] = max(f[i-1][j'] - |j-j'|) + points[i][j]
        è¿™æ ·æ—¶é—´å¤æ‚åº¦æ˜¯O(mn^2),è¶…æ—¶äº†ï¼Œä¼˜åŒ–åœ¨äºçŠ¶æ€è½¬ç§»æ–¹ç¨‹|j-j'|è¿™ä¸€é¡¹
        å½“j' <= j: f[i][j] = max(f[i-1][j'] - j + j') + points[i][j]
                           = max(f[i-1][j'] + j') - j + points[i][j]
        å½“j' > j:  f[i][j] = max(f[i-1][j'] - j') + j + points[i][j]
        """
        m, n = len(points), len(points[0])
        f = [[0] * n for _ in range(2)]
        for i in range(m):
            f[i&1] = [0] * n
            best = float('-inf')
            for j in range(n):
                best = max(best, f[(i-1)&1][j] + j)
                f[i&1][j] = max(f[i&1][j], best + points[i][j] - j)
            best = float('-inf')
            for j in range(n - 1, -1, -1):
                best = max(best, f[(i-1)&1][j] - j)
                f[i&1][j] = max(f[i&1][j], best + points[i][j] + j)
        return max(f[(m-1)&1])
# leetcode submit region end(Prohibit modification and deletion)
points = [[1,2,3],[1,5,1],[3,1,1]]
points = [[1,5],[2,3],[4,2]]
print(Solution().maxPoints(points))