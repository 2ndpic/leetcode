# ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ï¼Œæ•°ç»„ä¸­å…±æœ‰ n ä¸ªæ•´æ•°ã€‚132 æ¨¡å¼çš„å­åºåˆ— ç”±ä¸‰ä¸ªæ•´æ•° nums[i]ã€nums[j] å’Œ nums[k] ç»„æˆï¼Œå¹¶åŒæ—¶æ»¡è¶³
# ï¼ši < j < k å’Œ nums[i] < nums[k] < nums[j] ã€‚ 
# 
#  å¦‚æœ nums ä¸­å­˜åœ¨ 132 æ¨¡å¼çš„å­åºåˆ— ï¼Œè¿”å› true ï¼›å¦åˆ™ï¼Œè¿”å› false ã€‚ 
# 
#  
# 
#  è¿›é˜¶ï¼šå¾ˆå®¹æ˜“æƒ³åˆ°æ—¶é—´å¤æ‚åº¦ä¸º O(n^2) çš„è§£å†³æ–¹æ¡ˆï¼Œä½ å¯ä»¥è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º O(n logn) æˆ– O(n) çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿ 
# 
#  
# 
#  ç¤ºä¾‹ 1ï¼š 
# 
#  
# è¾“å…¥ï¼šnums = [1,2,3,4]
# è¾“å‡ºï¼šfalse
# è§£é‡Šï¼šåºåˆ—ä¸­ä¸å­˜åœ¨ 132 æ¨¡å¼çš„å­åºåˆ—ã€‚
#  
# 
#  ç¤ºä¾‹ 2ï¼š 
# 
#  
# è¾“å…¥ï¼šnums = [3,1,4,2]
# è¾“å‡ºï¼štrue
# è§£é‡Šï¼šåºåˆ—ä¸­æœ‰ 1 ä¸ª 132 æ¨¡å¼çš„å­åºåˆ—ï¼š [1, 4, 2] ã€‚
#  
# 
#  ç¤ºä¾‹ 3ï¼š 
# 
#  
# è¾“å…¥ï¼šnums = [-1,3,2,0]
# è¾“å‡ºï¼štrue
# è§£é‡Šï¼šåºåˆ—ä¸­æœ‰ 3 ä¸ª 132 æ¨¡å¼çš„çš„å­åºåˆ—ï¼š[-1, 3, 2]ã€[-1, 3, 0] å’Œ [-1, 2, 0] ã€‚
#  
# 
#  
# 
#  æç¤ºï¼š 
# 
#  
#  n == nums.length 
#  1 <= n <= 104 
#  -109 <= nums[i] <= 109 
#  
#  Related Topics æ ˆ 
#  ğŸ‘ 473 ğŸ‘ 0

from typing import List
class Solution:
    def find132pattern(self, nums: List[int]) -> bool:
        """
        è¶…æ—¶ã€‚æ•°æ®é‡åœ¨O(10^5)ã€‚æ—¶é—´å¤æ‚åº¦O(n^2)
        """
        for i in range(len(nums)):
            stack = [nums[i]]
            for j in nums[i + 1:]:
                if len(stack) == 1:
                    if j < stack[-1]:
                        stack.pop()
                    stack.append(j)
                elif len(stack) == 2:
                    if j > stack[-1]:
                        stack.pop()
                        stack.append(j)
                    elif stack[-2] < j < stack[-1]:
                        stack.append(j)
                if len(stack) == 3:
                    return True
        return False
class Solution:
    def find132pattern(self, nums: List[int]) -> bool:
        """
        ç›´è§‰å‘Šè¯‰æˆ‘è¿™æ˜¯ä¸€ä¸ªå•è°ƒæ ˆè§£å†³çš„é—®é¢˜ã€‚
        å…ˆå›ºå®šä¸€ä¸ªæ•°
        - å¦‚æœæšä¸¾iï¼Œéœ€è¦æ‰¾åˆ°jkå¯¹ï¼Œæ‰€ä»¥éœ€è¦ä»åå¾€å‰éå†ã€‚
            æ‰¾jkå¯¹è½¬æ¢ä¸ºæ‰¾kï¼Œåœ¨[i,k]åŒºé—´å†…å­˜åœ¨å¤§äºkçš„jï¼Œè¦åˆ©ç”¨kçŸ¥é“jçš„å­˜åœ¨ï¼Œå°±éœ€è¦ç»´æŠ¤ä¸€ä¸ªå•è°ƒæ ˆ
            è¿™ä¸ªå•è°ƒæ ˆçš„æ€§è´¨åœ¨äºkè¢«æ›´æ–°ï¼Œå¿…é¡»jæ¯”kå¤§ï¼Œæ‰€ä»¥ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å‡æ ˆï¼ˆæ ˆé¡¶æœ€å°ï¼‰
            ä¸€æ—¦kè¢«æ›´æ–°äº†ï¼Œå°±çŸ¥é“æ˜¯æœ‰ä¸€ä¸ªæ¯”kæ›´å¤§çš„æ•°æŠŠä¸€ä¸ªæ•°ä»å•è°ƒæ ˆpopå‡ºæ¥äº†ã€‚
            æ‰€ä»¥åªç”¨æ¯”è¾ƒiå’Œkçš„å€¼å³å¯ï¼Œkæ¯”iå¤§å³å­˜åœ¨jæ¯”iå¤§ and j å¿…å¤§äº k
        """
        stack = []
        k = float('-inf')
        for i in nums[::-1]:
            if k > i:
                return True
            while stack and i > stack[-1]:
                k = stack.pop()
            stack.append(i)
        return False
# leetcode submit region begin(Prohibit modification and deletion)
class Solution:
    def find132pattern(self, nums: List[int]) -> bool:
        """
        ç›´è§‰å‘Šè¯‰æˆ‘è¿™æ˜¯ä¸€ä¸ªå•è°ƒæ ˆè§£å†³çš„é—®é¢˜ã€‚
        å…ˆå›ºå®šä¸€ä¸ªæ•°
        - å¦‚æœæšä¸¾jï¼Œ
            ç”±äº j æ˜¯ 132 ç»“æ„é‡Œæœ€å¤§çš„æ•°ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ j çš„å³è¾¹ä¸­æ¯” j å°çš„ã€Œæœ€å¤§ã€çš„æ•°ï¼Œ
            åœ¨ j çš„å·¦è¾¹æ‰¾æ¯” j å°çš„ã€Œæœ€å°ã€çš„æ•°ã€‚
            è¿™å¾ˆå®¹æ˜“è”æƒ³åˆ°å•è°ƒæ ˆï¼Œä½†æ˜¯æœ´ç´ çš„å•è°ƒæ ˆæ˜¯å¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°å·¦è¾¹æˆ–è€…å³è¾¹ã€Œæœ€è¿‘ã€çš„æ•°ï¼Œæ— æ³•ç›´æ¥æ»¡è¶³æˆ‘ä»¬ã€Œæœ€å¤§ã€å’Œã€Œæœ€å°ã€çš„è¦æ±‚ï¼Œéœ€è¦å¼•å…¥é¢å¤–é€»è¾‘ã€‚
        """
        mj = []     # mi ç»´æŠ¤ nums[i] å·¦ä¾§çš„æœ€å°å€¼,miæ˜¯æœ‰å•è°ƒå‡çš„ï¼ˆæ ˆé¡¶æœ€å°ï¼‰
        stack = []  # ç»´æŠ¤ nums[i] å³ä¾§æ¯” mi[i] å¤§çš„å€¼
        for j in nums:
            if not mj:
                mj.append(j)
            else:
                mj.append(min(mj[-1], j))
        for j in range(len(nums)-1, -1, -1):
            if nums[j] > mj[j]:
                """
                ç°åœ¨nums[j]å³è¾¹æ‰¾ä¸€ä¸ªæ¯”mi[j]å¤§çš„å…ƒç´ 
                å¦‚æœæ ˆé¡¶æ¯”mi[j]è¦å°ï¼Œä¹‹åè‚¯å®šä¹Ÿä¸ä¼šç”¨åˆ°äº†ï¼Œä¸¢æ‰ï¼ˆå› ä¸ºmiè¶Šå¾€å·¦èµ°è¶Šå¤§ï¼‰
                æ ˆé¡¶åæ ‡>j,mj[j]åæ ‡å°äºjï¼Œå¦‚æœnums[j]çš„å€¼æ¯”æ ˆé¡¶å¤§ï¼Œå°±ç›´æ¥è¿”å›äº†
                """
                while stack and stack[-1] <= mj[j]:
                    stack.pop()
                if stack and stack[-1] < nums[j]:
                    return True
                stack.append(nums[j])
        return False



# leetcode submit region end(Prohibit modification and deletion)
nums = [1,2,3,4]
# nums = [3,1,4,2]
# nums = [-1,3,2,0]
# nums = [3,5,0,3,4] # True
print(Solution().find132pattern(nums))